<!DOCTYPE html><html lang="zh-cn" prefix="og: http://ogp.me/ns#"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>æ ‘å½¢DP Â· Steven's blog</title><meta name="description" content=""><meta name="og:title" content="æ ‘å½¢DP"><meta name="og:type" content="website"><meta name="og:url" content="http://example.com/2022/07/24/æ ‘å½¢DP/"><meta name="og:image" content="http://image.toast.com/aaaaahq/hola_cover.JPG"><meta name="og:description" content=""><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" href="/css/chiangmai.css"><meta name="steem:author" content="@stunstunstun"><meta name="fb:app_id" content="1258629384258634"><link rel="search" type="application/opensearchdescription+xml" href="http://example.com/atom.xml" title="Steven's blog"><meta name="generator" content="Hexo 6.1.0"><link rel="alternate" href="/atom.xml" title="Steven's blog" type="application/atom+xml">
</head><body class="post"><div id="fb-root"></div><div class="wrap"><header><nav class="navi-post"><a class="navi-post-back" href="javascript:history.back()"><i class="fa fa-arrow-left" aria-hidden="true"></i></a><a class="navi-post-home" href="/"><i class="fa fa-home" aria-hidden="true"></i></a></nav></header><main class="post"><div class="post"><article class="post-block"><h1 class="post-title">æ ‘å½¢DP</h1><div class="post-info"><div class="post-info-profile"><a href="https://github.com/stunstunstun" target="_blank"><img src="/image/profile.jpg"></a></div><div class="post-info-details"><div class="post-categories"><a href="/categories/%E6%8A%80%E6%9C%AF" target="_self"><span>æŠ€æœ¯</span></a></div><div class="post-date">2022å¹´7æœˆ24æ—¥</div></div></div><div class="post-share"><div class="fb-like" data-href="http://example.com/2022/07/24/æ ‘å½¢DP/" data-layout="button_count" data-action="like" data-size="small" data-show-faces="true" data-share="false">                 </div><div class="fb-share-button" data-href="http://example.com/2022/07/24/æ ‘å½¢DP/" data-layout="button" data-size="small" data-mobile-iframe="true"></div><div class="fb-follow" data-href="https://www.facebook.com/holaxprogramming/" data-layout="button_count" data-size="small" data-show-faces="true"></div></div><div class="post-content"><h3 id="æ ‘çš„æœ€é•¿è·¯å¾„">æ ‘çš„æœ€é•¿è·¯å¾„</h3>
<p><strong>é¢˜æ„ï¼š</strong> ç»™å®šä¸€ä¸ªå«æœ‰ <span
class="math inline">\(n\)</span> ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œä»¥åŠæ ‘ä¸­æ¯æ¡è¾¹çš„æƒå€¼ <span
class="math inline">\(w_i\)</span></p>
<p>ç°éœ€è¦åœ¨æ ‘ä¸­æ‰¾å‡ºä¸€æ¡è·¯å¾„ï¼Œä½¿å¾—è¯¥è·¯å¾„ä¸Šæ‰€æœ‰è¾¹çš„æƒå€¼ä¹‹å’Œæœ€å¤§</p>
<p>å¯¹äºæ±‚æ ‘çš„ç›´å¾„é—®é¢˜ï¼Œå¯ä»¥ç”¨ä¸¤æ¬¡ DFS æˆ–è€…æ ‘å½¢ DP çš„æ–¹æ³•åœ¨ <span
class="math inline">\(O(n)\)</span> æ—¶é—´æ±‚å‡ºæ ‘çš„ç›´å¾„</p>
<p>(ä¸¤æ¬¡ DFS æ— æ³•å¤„ç†è´Ÿæƒè¾¹)</p>
<h4 id="ä¸¤æ¬¡-dfsbfs">ä¸¤æ¬¡ DFS/BFS</h4>
<p><strong>åˆ†æï¼š</strong> é¦–å…ˆä»ä»»æ„èŠ‚ç‚¹ <span
class="math inline">\(y\)</span> å¼€å§‹ç¬¬ä¸€æ¬¡
DFSï¼Œåˆ°è¾¾è·ç¦»æœ€è¿œçš„èŠ‚ç‚¹ï¼Œè®°ä¸º <span class="math inline">\(z\)</span> ,
ç„¶åå†ä» <span class="math inline">\(z\)</span> å¼€å§‹å·¦ç¬¬äºŒæ¬¡ DFS</p>
<p>åˆ°è¾¾è·ç¦» <span class="math inline">\(z\)</span> æœ€è¿œçš„èŠ‚ç‚¹ï¼Œ è®°ä¸º
<span class="math inline">\(z&#39;\)</span>, åˆ™ <span
class="math inline">\((z,z&#39;)\)</span> å³ä¸ºæ ‘çš„ç›´å¾„</p>
<p><strong>è¯æ˜ï¼š</strong></p>
<p>æ˜¾ç„¶ï¼Œå¦‚æœç¬¬ä¸€æ¬¡ DFS åˆ°è¾¾çš„èŠ‚ç‚¹ <span
class="math inline">\(z\)</span> æ˜¯ç›´å¾„çš„ä¸€ç«¯ï¼Œé‚£ä¹ˆç¬¬äºŒæ¬¡ DFS åˆ°è¾¾çš„èŠ‚ç‚¹
<span class="math inline">\(z&#39;\)</span> ä¸€å®šæ˜¯ç›´å¾„çš„ä¸€ç«¯ã€‚</p>
<p>æˆ‘ä»¬åªéœ€è¯æ˜åœ¨ä»»æ„æƒ…å†µä¸‹ï¼Œ<span class="math inline">\(z\)</span>
å¿…ä¸ºç›´å¾„çš„ä¸€ç«¯ï¼Œå³å¯è¯æ˜ä¸Šè¿°åˆ†æçš„æ­£ç¡®æ€§</p>
<p>æˆ‘ä»¬ä½¿ç”¨åè¯æ³•ï¼Œè®°å‡ºå‘èŠ‚ç‚¹ä¸º y è®¾çœŸå®çš„ç›´å¾„æ˜¯ <span
class="math inline">\((s,t)\)</span></p>
<p>åˆ™å®šç†çš„åé¢ä¸ºï¼šè¿›è¡Œçš„ç¬¬ä¸€æ¬¡ DFS åˆ°è¾¾çš„èŠ‚ç‚¹ <span
class="math inline">\(z\)</span> ä¸ä¸º <span
class="math inline">\(s\)</span> æˆ– <span
class="math inline">\(z\)</span></p>
<p>å…±åˆ†ä¸‰ç§æƒ…å†µï¼š</p>
<ul>
<li><span class="math inline">\(y\)</span> åœ¨ç›´å¾„ <span
class="math inline">\((s, t)\)</span> ä¸Š</li>
</ul>
<p>å› ä¸º <span class="math inline">\(z\)</span> è·ç¦» <span
class="math inline">\(y\)</span> æœ€è¿œï¼Œ æ•… <span
class="math inline">\((y,z)\textgreater(y,t) \Rightarrow
(c,z)\textgreater(c,t) \Rightarrow (s,z) \textgreater (s,t)\)</span></p>
<p>å¦‚æœ <span class="math inline">\((s,z)\textgreater(s,t)\)</span> æ­¤æ—¶
<span class="math inline">\((s,z)\)</span> æ¯”ç›´å¾„æ›´é•¿ï¼Œæ•…çŸ›ç›¾</p>
<p>å¦‚æœ <span class="math inline">\((s,z)=(s, t)\)</span> æ­¤æ—¶è¯´æ˜ <span
class="math inline">\(z\)</span> ä¹Ÿæ˜¯ç›´å¾„çš„ä¸€ä¸ªç«¯ç‚¹</p>
<pre class="mermaid"><code>graph LR;
    s--&gt;y;
    y--&gt;c;
    c--&gt;t;
    c--&gt;z;</code></pre>
<ul>
<li><span class="math inline">\(y\)</span> ä¸åœ¨ç›´å¾„ <span
class="math inline">\((s, t)\)</span> ä¸Šï¼Œ <span
class="math inline">\((y, z)\)</span> å’Œ <span class="math inline">\((s,
t)\)</span> å­˜åœ¨é‡å¤è·¯å¾„</li>
</ul>
<p>â€‹ å› ä¸º <span class="math inline">\(z\)</span> è·ç¦» <span
class="math inline">\(y\)</span> æœ€è¿œï¼Œ æ•… <span
class="math inline">\((y,z)\geq(y,t) \Rightarrow (c,z)\ge(c,t)
\Rightarrow (s,z) \ge(s,t)\)</span></p>
<p>â€‹ å¦‚æœ <span class="math inline">\((s,z)\textgreater(s,t)\)</span>
æ­¤æ—¶ <span class="math inline">\((s,z)\)</span> æ¯”ç›´å¾„æ›´é•¿ï¼Œæ•…çŸ›ç›¾</p>
<p>â€‹ å¦‚æœ <span class="math inline">\((s,z)=(s, t)\)</span> æ­¤æ—¶è¯´æ˜
<span class="math inline">\(z\)</span> ä¹Ÿæ˜¯ç›´å¾„çš„ä¸€ä¸ªç«¯ç‚¹</p>
<pre class="mermaid"><code>graph LR;
    s--&gt;c;
    y--&gt;c;
    c--&gt;c&#39;
    c&#39;--&gt;t;
    c&#39;--&gt;z;</code></pre>
<ul>
<li><span class="math inline">\(y\)</span> ä¸åœ¨ç›´å¾„ <span
class="math inline">\((s, t)\)</span> ä¸Šï¼Œ <span
class="math inline">\((y, z)\)</span> å’Œ <span class="math inline">\((s,
t)\)</span> ä¸å­˜åœ¨é‡å¤è·¯å¾„</li>
</ul>
<p>â€‹ å› ä¸º <span class="math inline">\(z\)</span> è·ç¦» <span
class="math inline">\(y\)</span> æœ€è¿œï¼Œ æ•… <span
class="math inline">\((y, z) \ge (y, t) \Rightarrow (c&#39;, z)
\textgreater (c,t) \Rightarrow (s,z)\textgreater(s,t)\)</span></p>
<p>â€‹ æ­¤æ—¶ <span class="math inline">\((s,z)\)</span>
æ¯”ç›´å¾„æ›´é•¿ï¼Œæ•…çŸ›ç›¾</p>
<pre class="mermaid"><code>graph LR;
    s--&gt;c;
    c--&gt;t;
    c--&gt;c&#39;
    y--&gt;c&#39;;
    c&#39;--&gt;z;</code></pre>
<p><strong>å¤æ‚åº¦ï¼š</strong> <span
class="math inline">\(O(n)\)</span></p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="fl">1e5</span> <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> z<span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> d<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> e<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> fa<span class="op">)</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> v<span class="op">:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>v <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>        d<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> d<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d<span class="op">[</span>v<span class="op">]</span> <span class="op">&gt;</span> d<span class="op">[</span>z<span class="op">])</span> z <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    cin <span class="op">&gt;&gt;</span> n<span class="op">;</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span> b<span class="op">;</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        cin <span class="op">&gt;&gt;</span> a <span class="op">&gt;&gt;</span> b<span class="op">;</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        e<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>        e<span class="op">[</span>b<span class="op">].</span>push_back<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>    dfs<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span>  <span class="co">//  éšæ„å–ä¸€ä¸ªç‚¹ä¸ºæœ€åˆç‚¹</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">// dfså®Œå zå·²ç»è¢«æ›´æ–°ä¸ºè·ç¦»èµ·å§‹ç‚¹æœ€è¿œçš„ç‚¹äº†</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    d<span class="op">[</span>z<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// æ¢å¤ä¸€ä¸‹</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>    dfs<span class="op">(</span>z<span class="op">,</span> <span class="dv">0</span><span class="op">);</span> <span class="co">// ç¬¬äºŒæ¬¡dfs</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> d<span class="op">[</span>z<span class="op">]</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
<h4 id="æ ‘å½¢-dp">æ ‘å½¢ DP</h4>
<p><strong>åˆ†æï¼š</strong>
æˆ‘ä»¬è®°å½•å½“ä¸ºæ ‘çš„æ ¹æ—¶ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä½œä¸ºå­æ ‘çš„æ ¹å‘ä¸‹ï¼Œæ‰€èƒ½å»¶ä¼¸çš„æœ€è¿œè·ç¦» <span
class="math inline">\(d_1\)</span>ï¼Œå’Œæ¬¡è¿œè·ç¦» <span
class="math inline">\(d_2\)</span>ï¼Œé‚£ä¹ˆç›´</p>
<p>å¾„å°±æ˜¯æ‰€æœ‰ <span class="math inline">\(d_1+d_2\)</span> çš„æœ€å¤§å€¼</p>
<p><strong>çŠ¶æ€è¡¨ç¤ºï¼š</strong> <span
class="math inline">\(d_1[i]\)</span>, <span
class="math inline">\(d_2[i]\)</span> åˆ†åˆ«è¡¨ç¤ºä» <span
class="math inline">\(i\)</span> å¾€ä¸‹çš„æœ€é•¿è·¯å¾„å’Œæ¬¡é•¿è·¯å¾„( <span
class="math inline">\(d_1\)</span> å’Œ <span
class="math inline">\(d_2\)</span> åˆ†åˆ«å¯¹åº” <span
class="math inline">\(i\)</span> çš„ä¸åŒå­èŠ‚ç‚¹)</p>
<p><strong>çŠ¶æ€è®¡ç®—ï¼š</strong> <span class="math inline">\(ans =
\max(ans, d_1[i] + d_2[i])\)</span> å–å…¨å±€æœ€å¤§å€¼</p>
<p><strong>å¤æ‚åº¦ï¼š</strong> <span
class="math inline">\(O(n)\)</span></p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="fl">1e5</span> <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> PII<span class="op">;</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> ans <span class="op">=</span> <span class="op">-</span><span class="fl">2e9</span><span class="op">;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> d1<span class="op">[</span>N<span class="op">],</span> d2<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>PII<span class="op">&gt;</span> e<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> fa<span class="op">)</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    d1<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> d2<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> x<span class="op">:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v <span class="op">=</span> x<span class="op">.</span>first<span class="op">,</span> w <span class="op">=</span> x<span class="op">.</span>second<span class="op">;</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>v <span class="op">==</span> fa<span class="op">)</span>  <span class="co">// ä¿è¯åªå¾€ä¸‹æœç´¢</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> t <span class="op">=</span> d1<span class="op">[</span>v<span class="op">]</span> <span class="op">+</span> w<span class="op">;</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>t <span class="op">&gt;</span> d1<span class="op">[</span>u<span class="op">])</span>  <span class="co">// æ›´æ–°æœ€è¿œè·ç¦»(æ–°æ¬¡è¿œè·ç¦»ç­‰äºæ—§æœ€è¿œè·ç¦»)</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>            d2<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> d1<span class="op">[</span>u<span class="op">],</span> d1<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>t <span class="op">&gt;</span> d2<span class="op">[</span>u<span class="op">])</span>  <span class="co">// æ›´æ–°æ¬¡è¿œè·ç¦»</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>            d2<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> d1<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> d2<span class="op">[</span>u<span class="op">]);</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>    cin <span class="op">&gt;&gt;</span> n<span class="op">;</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span> b<span class="op">,</span> w<span class="op">;</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>        cin <span class="op">&gt;&gt;</span> a <span class="op">&gt;&gt;</span> b <span class="op">&gt;&gt;</span> w<span class="op">;</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>        e<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(&#123;</span>b<span class="op">,</span> w<span class="op">&#125;);</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>        e<span class="op">[</span>b<span class="op">].</span>push_back<span class="op">(&#123;</span>a<span class="op">,</span> w<span class="op">&#125;);</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    dfs<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span>  <span class="co">// ä»»æ„é€‰å–ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> ans <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
<h3 id="æ ‘çš„ä¸­å¿ƒ">æ ‘çš„ä¸­å¿ƒ</h3>
<p><strong>é¢˜æ„ï¼š</strong> ç»™å®šä¸€æ£µæ ‘ï¼Œæ ‘ä¸­åŒ…å« <span
class="math inline">\(n\)</span> ä¸ª èŠ‚ç‚¹ å’Œ <span
class="math inline">\(nâˆ’1\)</span> æ¡ æ— å‘è¾¹ï¼Œæ¯æ¡è¾¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ <span
class="math inline">\(w_i\)</span></p>
<p>è¯·åœ¨æ ‘ä¸­æ‰¾åˆ°ä¸€ä¸ªç‚¹ï¼Œä½¿å¾—è¯¥ç‚¹åˆ°æ ‘ä¸­å…¶ä»–ç»“ç‚¹çš„æœ€è¿œè·ç¦»æœ€è¿‘,
è¾“å‡ºè¿™ä¸ªæœ€è¿œè·ç¦»</p>
<p><strong>åˆ†æï¼š</strong></p>
<p>è¿™ä¸ªé—®é¢˜æ˜¯æ ‘å½¢ DP ä¸­çš„ä¸€ç±»ç»å…¸æ¨¡å‹ï¼Œå¸¸è¢«ç§°ä½œ<strong>æ¢æ ¹
DP</strong>ï¼Œ ä¸€èˆ¬åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<ul>
<li><p>æŒ‡å®šä»»æ„ä¸€ä¸ªæ ¹èŠ‚ç‚¹</p></li>
<li><p>ä¸€æ¬¡ dfs
éå†ï¼Œç»Ÿè®¡å‡ºå½“å‰å­æ ‘å†…çš„èŠ‚ç‚¹å¯¹å½“å‰èŠ‚ç‚¹çš„è´¡çŒ®(è·ç¦»)</p></li>
<li><p>ä¸€æ¬¡ dfs
éå†ï¼Œç»Ÿè®¡å‡ºå½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å¯¹å½“å‰èŠ‚ç‚¹çš„è´¡çŒ®(è·ç¦»)ï¼Œç„¶ååˆå¹¶ç»Ÿè®¡ç­”æ¡ˆ</p></li>
</ul>
<p>å¯¹äºä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬å…ˆ dfs
é¢„å¤„ç†äº†æ¯ä¸ªç‚¹ä»¥è¯¥èŠ‚ç‚¹ä¸ºæ ¹ï¼Œèµ°çš„çš„æœ€è¿œè·ç¦»å’Œæ¬¡è¿œè·ç¦»å</p>
<p>å¦‚æœæƒ³è¦æ±‚å‡ºæ ‘ä¸­ç¦»è¯¥èŠ‚ç‚¹æœ€è¿œçš„è·ç¦»æ—¶ï¼Œå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§å­æƒ…å†µ (ä»¥
<span class="math inline">\(v\)</span> ä¸ºä¾‹)</p>
<ul>
<li><p>æœ€è¿œè·ç¦»å‡ºç°åœ¨è¯¥èŠ‚ç‚¹å¾€ä¸‹èµ°çš„è·¯å¾„ä¸­ ( <span
class="math inline">\(d_1\)</span> å’Œ <span
class="math inline">\(d_2\)</span> ä¸­æ˜¾ç„¶å– <span
class="math inline">\(d_1\)</span> æ›´å¥½)</p></li>
<li><p>æœ€è¿œè·ç¦»å‡ºç°åœ¨è¯¥èŠ‚ç‚¹å¾€ä¸Šèµ°çš„è·¯å¾„ä¸­ï¼Œæ­¤æ—¶éœ€è¦é¢å¤–è€ƒè™‘ <span
class="math inline">\(v\)</span> çš„çˆ¶èŠ‚ç‚¹ <span
class="math inline">\(u\)</span> å– <span
class="math inline">\(d_1\)</span> æ—¶é€‰å–çš„å­èŠ‚ç‚¹æ˜¯å¦æ˜¯ <span
class="math inline">\(v\)</span></p>
<p>å¯ä»¥æƒ³åˆ°ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ç¬¬ä¸€æ¬¡ dfs å°†èŠ‚ç‚¹ <span
class="math inline">\(u\)</span> å–åˆ°æœ€è¿œè·ç¦»æ—¶çš„å­èŠ‚ç‚¹è®°ä¸º <span
class="math inline">\(s_u\)</span> , é‚£åˆå¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸¤ç§æƒ…å†µ</p>
<ul>
<li><span class="math inline">\(s_u \neq v\)</span> é‚£ä¹ˆå¯ä»¥ç”¨ <span
class="math inline">\(d_1[u]\)</span> (<span
class="math inline">\(u\)</span> å¾€ä¸‹çš„æœ€è¿œè·ç¦») è¿›è¡Œè½¬ç§»</li>
<li><span class="math inline">\(s_u = v\)</span> é‚£ä¹ˆå°±åªèƒ½ç”¨ <span
class="math inline">\(d_2[u]\)</span> (<span
class="math inline">\(u\)</span> å¾€ä¸‹çš„æ¬¡è¿œè·ç¦») è¿›è¡Œè½¬ç§», å› ä¸ºä¸å¯ä»¥ä»
<span class="math inline">\(v\)</span> å¾€ä¸Šåˆ° <span
class="math inline">\(u\)</span> åˆå¾€ä¸‹èµ°å› <span
class="math inline">\(v\)</span></li>
</ul></li>
</ul>
<pre class="mermaid"><code>graph TD;
    u --&gt; v;
    u --&gt; d1_u;
    u --&gt; d2_u;
    v --&gt; d1_v;
    v --&gt; d2_v;</code></pre>
<p>æ•…åœ¨æ•´ä¸ªè¿‡ç¨‹ä¹‹ä¸­ï¼Œå¯¹äºä¸€ä¸ªèŠ‚ç‚¹ <span class="math inline">\(u\)</span>
éœ€è¦è®°å½•çš„æœ‰</p>
<ul>
<li>å¾€ä¸‹èµ°çš„æœ€è¿œè·ç¦» <span class="math inline">\(d_1[u]\)</span>
(å¾€å­èŠ‚ç‚¹ <span class="math inline">\(s[u]\)</span> èµ°)</li>
<li>å¾€ä¸‹èµ°çš„æ¬¡è¿œè·ç¦» <span class="math inline">\(d_2[u]\)</span></li>
<li>æ¯ä¸ªç‚¹å¾€ä¸Šèµ°çš„æœ€è¿œè·ç¦» <span
class="math inline">\(up[u]\)</span></li>
</ul>
<p>é‚£ä¹ˆï¼Œæœ€åéå†æ‰€æœ‰èŠ‚ç‚¹ï¼Œå– <span
class="math inline">\(\max(d_1[u],up[u])\)</span> ä¸­æœ€å°çš„å³å¯</p>
<p><strong>çŠ¶æ€è¡¨ç¤ºï¼š</strong></p>
<ul>
<li><span class="math inline">\(d_1[u]\)</span> å¾€ä¸‹èƒ½èµ°åˆ°æœ€è¿œè·ç¦»</li>
<li><span class="math inline">\(d_2[u]\)</span>
å¾€ä¸‹èƒ½èµ°åˆ°çš„æ¬¡è¿œè·ç¦»</li>
<li><span class="math inline">\(s[u]\)</span> å­˜ä¸‹ <span
class="math inline">\(u\)</span>
èŠ‚ç‚¹å‘ä¸‹èµ°çš„æœ€é•¿è·¯å¾„æ˜¯ä»å“ªä¸€ä¸ªèŠ‚ç‚¹ä¸‹å»çš„</li>
<li><span class="math inline">\(up[u]\)</span> å¾€ä¸Šèµ°çš„æœ€è¿œè·ç¦»</li>
</ul>
<p><strong>çŠ¶æ€è®¡ç®—ï¼š</strong></p>
<p><span class="math inline">\(son_u \neq v \longrightarrow up[v] = w +
\max(up[u], d_1[u])\)</span> ç”¨æœ€è¿œè·ç¦»æ›´æ–°</p>
<p><span class="math inline">\(son_u = v \longrightarrow up[v] = w +
\max(up[u], d_2[u])\)</span> ç”¨æ¬¡è¿œè·ç¦»æ›´æ–°</p>
<p><span class="math inline">\(ans = \min\left(ans, \max(d_1[u] +
up[u])\right)\)</span> å–å…¨å±€æœ€å¤§å€¼</p>
<p><strong>å¤æ‚åº¦ï¼š</strong> <span
class="math inline">\(O(n)\)</span></p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">10010</span><span class="op">,</span> INF <span class="op">=</span> <span class="bn">0x3f3f3f3f</span><span class="op">;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> PII<span class="op">;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>PII<span class="op">&gt;</span> e<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> d1<span class="op">[</span>N<span class="op">],</span> d2<span class="op">[</span>N<span class="op">],</span> s1<span class="op">[</span>N<span class="op">],</span> up<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs1<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> fa<span class="op">)</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    d1<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> d2<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="op">-</span>INF<span class="op">;</span>  <span class="co">//æœ¬é¢˜è¾¹æƒéƒ½æ˜¯æ­£çš„ï¼Œå¯ä»¥ä¸ç”¨åˆå§‹åŒ–ä¸ºè´Ÿæ— ç©·</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> w<span class="op">]:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>v <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>        dfs1<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> t <span class="op">=</span> d1<span class="op">[</span>v<span class="op">]</span> <span class="op">+</span> w<span class="op">;</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>t <span class="op">&gt;</span> d1<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#123;</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>            d2<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> d1<span class="op">[</span>u<span class="op">];</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>            d1<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>            s1<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> v<span class="op">;</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#125;</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span><span class="op">(</span>t <span class="op">&gt;</span> d2<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#123;</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>            d2<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#125;</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">// å¦‚æœåˆå§‹åŒ–ä¸ºè´Ÿæ— ç©·éœ€è¦ç‰¹åˆ¤å¶å­èŠ‚ç‚¹</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span><span class="op">(</span>d1<span class="op">[</span>u<span class="op">]</span> <span class="op">==</span> <span class="op">-</span>INF<span class="op">)</span> d1<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> d2<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs2<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> fa<span class="op">)</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> w<span class="op">]:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>s1<span class="op">[</span>u<span class="op">]</span> <span class="op">==</span> v<span class="op">)</span>  up<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> w <span class="op">+</span> max<span class="op">(</span>up<span class="op">[</span>u<span class="op">],</span> d2<span class="op">[</span>u<span class="op">]);</span>  <span class="co">// son_u = v, ç”¨æ¬¡è¿œè·ç¦»æ›´æ–°</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> up<span class="op">[</span>v<span class="op">]</span> <span class="op">=</span> w <span class="op">+</span> max<span class="op">(</span>up<span class="op">[</span>u<span class="op">],</span> d1<span class="op">[</span>u<span class="op">]);</span>  <span class="co">// son_u != v, ç”¨æœ€è¿œè·ç¦»æ›´æ–°</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>        dfs2<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>    cin <span class="op">&gt;&gt;</span> n<span class="op">;</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span> b<span class="op">,</span> c<span class="op">;</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>        cin <span class="op">&gt;&gt;</span> a <span class="op">&gt;&gt;</span> b <span class="op">&gt;&gt;</span> c<span class="op">;</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>        e<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(&#123;</span>b<span class="op">,</span> c<span class="op">&#125;);</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>        e<span class="op">[</span>b<span class="op">].</span>push_back<span class="op">(&#123;</span>a<span class="op">,</span> c<span class="op">&#125;);</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>    dfs1<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span>  <span class="co">// å¤„ç†å‘ä¸‹çš„æœ€è¿œè·ç¦»å’Œæ¬¡è¿œè·ç¦»</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>    dfs2<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span>  <span class="co">// å¤„ç†å‘ä¸Šçš„æœ€è¿œè·ç¦»</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ans <span class="op">=</span> INF<span class="op">;</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span> ans <span class="op">=</span> min<span class="op">(</span>ans<span class="op">,</span> max<span class="op">(</span>d1<span class="op">[</span>i<span class="op">],</span> up<span class="op">[</span>i<span class="op">]));</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> ans <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
<h3 id="æ•°å­—è½¬æ¢">æ•°å­—è½¬æ¢</h3>
<p><strong>é¢˜æ„ï¼š</strong> å¦‚æœä¸€ä¸ªæ•° <span
class="math inline">\(x\)</span> çš„ çº¦æ•°ä¹‹å’Œ
y(ä¸åŒ…æ‹¬ä»–æœ¬èº«)æ¯”ä»–æœ¬èº«å°ï¼Œé‚£ä¹ˆ <span class="math inline">\(x\)</span>
å’Œ <span class="math inline">\(y\)</span> å¯ä»¥äº’ç›¸è½¬æ¢</p>
<p>ç»™å®šä¸€ä¸ªæ­£æ•´æ•° <span class="math inline">\(n\)</span>ï¼Œæ±‚å‡ºåœ¨ç”±æ­£æ•´æ•°
<span class="math inline">\(1\sim n\)</span>
æ„æˆçš„æ•°é›†ä¸­ï¼šåœ¨ä¸å‡ºç°é‡å¤æ•°å­—çš„æƒ…å†µä¸‹ï¼Œèƒ½è¿›è¡Œçš„æœ€å¤§å˜æ¢æ­¥æ•°</p>
<p><strong>åˆ†æï¼š</strong> é¦–å…ˆæˆ‘ä»¬è€ƒè™‘å¦‚ä½•å¤„ç†çº¦æ•°ä¹‹å’Œï¼Œå¦‚æœå¯¹äºæ¯ä¸€ä¸ª
<span class="math inline">\(1\sim n\)</span>
ä¹‹é—´çš„æ•°ï¼Œæˆ‘ä»¬é‡‡ç”¨æœ´ç´ çš„è¯•é™¤æ³•è¿›è¡Œå¤„ç†ï¼Œ</p>
<p>å¤æ‚åº¦ä¸º <span class="math inline">\(O(n\sqrt{n})\)</span>
æ˜¯å¯èƒ½ä¼šè¶…æ—¶çš„ï¼Œæ‰€ä»¥æ¢ä¸€ç§ <span class="math inline">\(O(nlogn)\)</span>
çš„æ–¹æ³•æˆ‘ä»¬å¯ä»¥è€ƒè™‘å¯¹äºå½“å‰æšä¸¾åˆ°çš„æ•° <span
class="math inline">\(x\)</span>ï¼Œæšä¸¾</p>
<p><span class="math inline">\(x\)</span> å¯¹ <span
class="math inline">\((x + 1)\sim n\)</span> ä¹‹é—´çš„æ•°çš„è´¡çŒ®ï¼Œæ˜¾ç„¶ <span
class="math inline">\(x\)</span> èƒ½ä½¿å¾— <span class="math inline">\(2x,
3x \dots kx\)</span> çš„çº¦æ•°ä¹‹å’Œéƒ½å¢åŠ  <span
class="math inline">\(x\)</span> (<span class="math inline">\(x\)</span>
ä¸æ˜¯ <span class="math inline">\(x\)</span> çš„çº¦æ•°)</p>
<p>ç„¶åå¤„ç†è½¬æ¢çš„é—®é¢˜ï¼Œå¦‚æœ <span class="math inline">\(x\)</span>
çš„çº¦æ•°ä¹‹å’Œ <span class="math inline">\(y\)</span> æ¯”å®ƒæœ¬èº«å°, é‚£ä¹ˆ <span
class="math inline">\(x\)</span> å’Œ <span
class="math inline">\(y\)</span> å¯ä»¥äº’ç›¸è½¬æ¢ï¼Œç­‰ä»·äºå¯ä»¥åœ¨ x å’Œ y</p>
<p>ä¹‹é—´è¿ä¸€æ¡æ— å‘è¾¹ï¼Œç”±äºæ¯ä¸ªæ•°çš„çº¦æ•°ä¹‹å’Œæ˜¯ç¡®å®šçš„ï¼Œæ‰€ä»¥æ‰€æœ‰çš„è¿™æ ·çš„è¾¹ä¸€èµ·ç»„æˆäº†ä¸€ä¸ªæ£®æ—
ğŸŒ´</p>
<p>è¿™æ ·è¦æ±‚çš„æœ€å¤§è½¬æ¢æ­¥æ•°å°±å¯ä»¥è½¬åŒ–æ±‚è§£ä¸ºè¿™ä¸ªæ£®æ—ä¸­çš„æ ‘çš„ç›´å¾„çš„æœ€å¤§å€¼ï¼Œ</p>
<p>ç±»æ¯”ä¸Šé¢çš„æ ‘çš„æœ€é•¿è·¯å¾„ï¼Œå¯ä»¥æšä¸¾æ¯ä¸ªç‚¹ä½œä¸ºæ ¹çš„æƒ…å†µï¼Œç„¶åå–å…¨å±€æœ€å¤§å€¼å³å¯</p>
<p>ä½†æ˜¯æœç´¢æ—¶çˆ†æ ˆäº† â“</p>
<p>è¿™è¯´æ˜å­˜å‚¨çš„è¿™ä¸ªè¿‡ç¨‹è¿˜æœ‰ä¼˜åŒ–çš„ç©ºé—´ï¼Œå…¶å®ç”±äºæˆ‘ä»¬æšä¸¾äº†æ¯ä¸€ä¸ªç‚¹ä½œä¸ºæ ¹èŠ‚ç‚¹çš„æƒ…å†µï¼Œæ‰€ä»¥æ¯æ¬¡åªéœ€è¦å­˜å…¥ä¸€</p>
<p>æ¡æœ‰å‘è¾¹å³å¯ï¼Œ åŒæ—¶è¦é‡‡ç”¨è®°å¿†åŒ–çš„æœç´¢æ–¹å¼</p>
<p><strong>çŠ¶æ€è¡¨ç¤ºï¼š</strong> <span
class="math inline">\(d_1[i]\)</span>, <span
class="math inline">\(d_2[i]\)</span> åˆ†åˆ«è¡¨ç¤ºä» <span
class="math inline">\(i\)</span> å¾€ä¸‹çš„æœ€é•¿è·¯å¾„å’Œæ¬¡é•¿è·¯å¾„( <span
class="math inline">\(d_1\)</span> å’Œ <span
class="math inline">\(d_2\)</span> åˆ†åˆ«å¯¹åº” <span
class="math inline">\(i\)</span> çš„ä¸åŒå­èŠ‚ç‚¹)</p>
<p><strong>çŠ¶æ€è®¡ç®—ï¼š</strong> <span class="math inline">\(ans =
\max(ans, d_1[i] + d_2[i])\)</span> å–å…¨å±€æœ€å¤§å€¼</p>
<p><strong>å¤æ‚åº¦ï¼š</strong> <span
class="math inline">\(O(nlogn)\)</span></p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">50005</span><span class="op">;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a<span class="op">[</span>N<span class="op">],</span> d1<span class="op">[</span>N<span class="op">],</span> d2<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ans <span class="op">=</span> <span class="op">-</span><span class="fl">2e9</span><span class="op">;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> e<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">)</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d1<span class="op">[</span>u<span class="op">])</span>  <span class="co">// è®°å¿†åŒ–</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> v<span class="op">:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> t <span class="op">=</span> d1<span class="op">[</span>v<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>t <span class="op">&gt;</span> d1<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#123;</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>            d2<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> d1<span class="op">[</span>u<span class="op">];</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>            d1<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#125;</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>t <span class="op">&gt;</span> d2<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>            d2<span class="op">[</span>u<span class="op">]</span> <span class="op">=</span> t<span class="op">;</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>    ans <span class="op">=</span> max<span class="op">(</span>ans<span class="op">,</span> d1<span class="op">[</span>u<span class="op">]</span> <span class="op">+</span> d2<span class="op">[</span>u<span class="op">]);</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>    cin <span class="op">&gt;&gt;</span> n<span class="op">;</span></span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> j <span class="op">&lt;=</span> n <span class="op">/</span> i<span class="op">;</span> j <span class="op">++</span> <span class="op">)</span>  <span class="co">// ä»2å¼€å§‹, ä¸€ä¸ªæ•°çš„çº¦æ•°ä¸å«å®ƒæœ¬èº«</span></span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>            a<span class="op">[</span>i <span class="op">*</span> j<span class="op">]</span> <span class="op">+=</span> i<span class="op">;</span></span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span><span class="op">(</span>i <span class="op">&gt;</span> a<span class="op">[</span>i<span class="op">])</span></span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>            e<span class="op">[</span>a<span class="op">[</span>i<span class="op">]].</span>push_back<span class="op">(</span>i<span class="op">);</span>  <span class="co">// è™½ç„¶æ˜¯å¯ä»¥åŒå‘è½¬ç§»ï¼Œä½†æ˜¯å®é™…ä¸Šåªéœ€è¦è¿ä¸€æ¡æœ‰å‘è¾¹å³å¯(å› ä¸ºä¼šæšä¸¾æ‰€æœ‰çš„æƒ…å†µ)</span></span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>i<span class="op">);</span>   <span class="co">// æšä¸¾ä»¥æ¯ä¸€æ¡è¾¹ä¸ºæ ¹èŠ‚ç‚¹çš„æƒ…å†µ</span></span>
<span id="cb8-46"><a href="#cb8-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-47"><a href="#cb8-47" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> ans <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb8-48"><a href="#cb8-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-49"><a href="#cb8-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb8-50"><a href="#cb8-50" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
<h3 id="äºŒå‰è‹¹æœæ ‘">äºŒå‰è‹¹æœæ ‘</h3>
<p><strong>é¢˜æ„ï¼š</strong> ç»™å®šä¸€æ£µå«æœ‰ <span
class="math inline">\(n\)</span> ä¸ªç»“ç‚¹çš„æ ‘ï¼Œæ ‘æ ¹ç¼–å·ä¸º
1ï¼Œä¸”æ ‘ä¸Šçš„æ¯æ¡è¾¹æœ‰ä¸€ä¸ªè¾¹æƒ <span class="math inline">\(w_i\)</span></p>
<p>è¦æ±‚æˆ‘ä»¬è¿›è¡Œå‡æï¼Œåªä¿ç•™æ ‘ä¸­çš„ <span class="math inline">\(m\)</span>
æ¡è¾¹ï¼Œä½¿å¾—æ ‘æ ¹(ç¼–å·ä¸º 1)æ‰€åœ¨çš„è¿é€šå—çš„æ‰€æœ‰è¾¹çš„è¾¹æƒä¹‹å’Œæœ€å¤§</p>
<p><strong>åˆ†æï¼š</strong>
è¿™é¢˜çš„æœ¬è´¨å…¶å®æ˜¯æœ‰ä¾èµ–çš„èƒŒåŒ…æ¨¡å‹ï¼Œä¸åŒç‚¹åœ¨äºæŠŠç‰©å“ä»·å€¼åˆ†é…ç»™äº†è¾¹è€Œä¸æ˜¯ç‚¹</p>
<p>ä¸è¿‡å¯¹äºæ ‘ç»“æ„æ¥è¯´ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹çš„å…¥è¾¹ä»…æœ‰ä¸€æ¡ï¼Œæ‰€ä»¥å¯ä»¥å°†æ¯ä¸€ä¸ªèŠ‚ç‚¹çš„å…¥è¾¹æƒè§†ä½œè¯¥ç‚¹çš„ä»·å€¼</p>
<p>å¯¹äºæœ‰ä¾èµ–çš„èƒŒåŒ…é—®é¢˜ï¼Œæœ‰ä¸¤ç§å¸¸è§çš„å¤„ç†æ–¹å¼</p>
<ul>
<li>æŒ‰å­ç‰©ä½“ä½“ç§¯é›†åˆåˆ’åˆ† <span class="math inline">\(O(N \times V\times
V)\)</span></li>
<li>åˆ†ç»„èƒŒåŒ…é›†åˆåˆ’åˆ†, å°†ä¾èµ–å…³ç³»è½¬åŒ–ä¸ºå¤šç§ç»„åˆ <span
class="math inline">\(O(N \times 2^k \times V)\)</span></li>
</ul>
<p>è¿™é‡Œé‡‡ç”¨ä½“ç§¯(è¾¹æ•°)åˆ’åˆ†æ–¹æ¡ˆå¤æ‚åº¦è¾ƒä½,
æšä¸¾å½“å‰èŠ‚ç‚¹çš„è¾¹æ•°å’Œå­æ ‘å†…çš„è¾¹æ•°è¿›è¡Œè½¬ç§»å³å¯</p>
<p><strong>çŠ¶æ€è¡¨ç¤ºï¼š</strong> <span
class="math inline">\(f[i][j]\)</span> è¡¨ç¤ºä»¥ <span
class="math inline">\(i\)</span> ä¸ºæ ¹èŠ‚ç‚¹çš„å­æ ‘ï¼Œè”é€šå—å†…è¾¹æ•°ä¸è¶…è¿‡
<span class="math inline">\(j\)</span> çš„æƒ…å†µä¸‹è¾¹æƒæœ€å¤§å€¼</p>
<p><strong>çŠ¶æ€è®¡ç®—ï¼š</strong> <span class="math inline">\(f[u][j] =
max(f[u][j], f[u][j - k - 1] + f[v][k] + w)\)</span> (æšä¸¾ä»¥ <span
class="math inline">\(v\)</span> ä¸ºæ ¹çš„å­æ ‘å†…è¾¹æ•° <span
class="math inline">\(k\)</span> )</p>
<p><strong>å¤æ‚åº¦ï¼š</strong> <span class="math inline">\(O(n\cdot
m^2)\)</span></p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> PII<span class="op">;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">105</span><span class="op">;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">,</span> m<span class="op">;</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> f<span class="op">[</span>N<span class="op">][</span>N<span class="op">];</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span>PII<span class="op">&gt;</span> e<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">,</span> <span class="dt">int</span> fa<span class="op">)</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> <span class="op">[</span>v<span class="op">,</span> w<span class="op">]:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>v <span class="op">==</span> fa<span class="op">)</span> <span class="cf">continue</span><span class="op">;</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">,</span> u<span class="op">);</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> m<span class="op">;</span> j <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">--</span> <span class="op">)</span>  <span class="co">// æšä¸¾è¾¹æ•°</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;=</span> j <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> k <span class="op">++</span> <span class="op">)</span>  <span class="co">// æšä¸¾å­æ ‘çš„è¾¹æ•°(ç•™ä¸€æ¡ç”¨äºä» u --&gt; v )</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                f<span class="op">[</span>u<span class="op">][</span>j<span class="op">]</span> <span class="op">=</span> max<span class="op">(</span>f<span class="op">[</span>u<span class="op">][</span>j<span class="op">],</span> f<span class="op">[</span>u<span class="op">][</span>j <span class="op">-</span> k <span class="op">-</span> <span class="dv">1</span><span class="op">]</span> <span class="op">+</span> f<span class="op">[</span>v<span class="op">][</span>k<span class="op">]</span> <span class="op">+</span> w<span class="op">);</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    cin <span class="op">&gt;&gt;</span> n <span class="op">&gt;&gt;</span> m<span class="op">;</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span> b<span class="op">,</span> c<span class="op">;</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        cin <span class="op">&gt;&gt;</span> a <span class="op">&gt;&gt;</span> b <span class="op">&gt;&gt;</span> c<span class="op">;</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        e<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(&#123;</span>b<span class="op">,</span> c<span class="op">&#125;);</span>  <span class="co">// æ— å‘è¾¹</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        e<span class="op">[</span>b<span class="op">].</span>push_back<span class="op">(&#123;</span>a<span class="op">,</span> c<span class="op">&#125;);</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    dfs<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    cout <span class="op">&lt;&lt;</span> f<span class="op">[</span><span class="dv">1</span><span class="op">][</span>m<span class="op">]</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
<h3 id="æ²¡æœ‰ä¸Šå¸çš„èˆä¼š">æ²¡æœ‰ä¸Šå¸çš„èˆä¼š</h3>
<p><strong>é¢˜æ„ï¼š</strong> ç»™å®šä¸€æ£µå«æœ‰ <span
class="math inline">\(n\)</span> ä¸ªç»“ç‚¹çš„æ ‘ï¼Œæ ‘æ ¹ç¼–å·ä¸º
1ï¼Œä¸”æ ‘ä¸Šçš„æ¯æ¡èŠ‚ç‚¹æœ‰ä¸€ä¸ªæƒå€¼ <span class="math inline">\(a_i\)</span>
ï¼Œå¯¹äºæ¯ä¸€æ¡è¾¹ï¼Œä»…èƒ½</p>
<p>é€‰å–ä¸€ä¸ªç«¯ç‚¹ï¼Œæ±‚é€‰å–èŠ‚ç‚¹ä½¿å¾—æƒå€¼ä¹‹å’Œæœ€å¤§</p>
<p><strong>åˆ†æï¼š</strong>
å¯¹äºä¸€ä¸ªèŠ‚ç‚¹æ˜¯å¦é€‰å–ä¼šå¯¹å…¶ä»–å†³ç­–äº§ç”Ÿå½±å“ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨çŠ¶æ€è½¬ç§»çš„æ—¶å€™è®°å½•ä¸‹å½“å‰èŠ‚ç‚¹çš„çŠ¶æ€</p>
<p>ä¹Ÿå°±æ˜¯çŠ¶æ€æœºæ¨¡å‹ï¼Œå¯ä»¥å•ç‹¬å¼€ä¸€ç»´ç”¨äºè®°å½•æ˜¯å¦é€‰å–è¯¥èŠ‚ç‚¹ï¼Œç„¶åè€ƒè™‘å¯¹äºå½“å‰èŠ‚ç‚¹ï¼Œæœ‰ä¸¤ç§è½¬ç§»æ–¹å¼</p>
<ul>
<li>å¯¹äºä¸é€‰å½“å‰èŠ‚ç‚¹çš„ï¼Œå­èŠ‚ç‚¹å¯é€‰å¯ä¸é€‰</li>
<li>å¯¹äºé€‰å–äº†å½“å‰èŠ‚ç‚¹çš„ï¼Œç”±äºä¸€æ¡è¾¹ä¸Šåªèƒ½é€‰å–ä¸€ä¸ªç‚¹ï¼Œæ‰€ä»¥å­èŠ‚ç‚¹ä¸€å®šä¸èƒ½é€‰æ‹©</li>
</ul>
<p>æœ€åå– <span class="math inline">\(f[root][0]\)</span> å’Œ <span
class="math inline">\(f[root][1]\)</span> ä¸­çš„è¾ƒå¤§å€¼å³ä½ç­”æ¡ˆ</p>
<p><strong>çŠ¶æ€è¡¨ç¤ºï¼š</strong></p>
<ul>
<li><p><span class="math inline">\(f[u][0]\)</span> ä»¥ <span
class="math inline">\(u\)</span> ä¸ºæ ¹çš„å­æ ‘ä¸­é€‰æ‹©ï¼Œå¹¶ä¸”ä¸é€‰ <span
class="math inline">\(u\)</span> è¿™ä¸ªç‚¹çš„æƒå€¼ä¹‹å’Œæœ€å¤§å€¼</p></li>
<li><p><span class="math inline">\(f[u][1]\)</span> ä»¥ <span
class="math inline">\(u\)</span> ä¸ºæ ¹çš„å­æ ‘ä¸­é€‰æ‹©ï¼Œå¹¶ä¸”é€‰æ‹© <span
class="math inline">\(u\)</span> è¿™ä¸ªç‚¹çš„æƒå€¼ä¹‹å’Œæœ€å¤§å€¼</p></li>
</ul>
<p><strong>çŠ¶æ€è®¡ç®—ï¼š</strong> å¯¹äºå½“å‰èŠ‚ç‚¹ <span
class="math inline">\(u\)</span> çš„æ‰€æœ‰å­èŠ‚ç‚¹ <span
class="math inline">\(v\)</span></p>
<ul>
<li><span class="math inline">\(f[u][0] = \sum \max(f[v][0],
f[v][1])\)</span> æ²¡é€‰å– <span
class="math inline">\(u\)</span>ï¼Œå¯ä»¥é€‰æ‹© <span
class="math inline">\(v\)</span></li>
<li><span class="math inline">\(f[u][1] = \sum f[v][0]\)</span> é€‰å–äº†
<span class="math inline">\(u\)</span>ï¼Œä¸èƒ½é€‰å– <span
class="math inline">\(v\)</span></li>
</ul>
<p><strong>å¤æ‚åº¦ï¼š</strong> <span
class="math inline">\(O(n)\)</span></p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="fl">1e4</span> <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a<span class="op">[</span>N<span class="op">],</span> fa<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> f<span class="op">[</span>N<span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> e<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">)</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    f<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> a<span class="op">[</span>u<span class="op">];</span>  <span class="co">// åŠ ä¸Šå½“å‰èŠ‚ç‚¹çš„å€¼</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> v<span class="op">:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        f<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">+=</span> max<span class="op">(</span>f<span class="op">[</span>v<span class="op">][</span><span class="dv">0</span><span class="op">],</span> f<span class="op">[</span>v<span class="op">][</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        f<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">+=</span> f<span class="op">[</span>v<span class="op">][</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    cin <span class="op">&gt;&gt;</span> n<span class="op">;</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        cin <span class="op">&gt;&gt;</span> a<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span> b<span class="op">;</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        cin <span class="op">&gt;&gt;</span> a <span class="op">&gt;&gt;</span> b<span class="op">;</span>  <span class="co">// b æ˜¯ä¸Šå¸</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        e<span class="op">[</span>b<span class="op">].</span>push_back<span class="op">(</span>a<span class="op">);</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        fa<span class="op">[</span>a<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// æœ‰ä¸Šå¸ï¼Œç”¨äºåˆ¤æ–­æ ¹èŠ‚ç‚¹</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> u <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> u <span class="op">&lt;=</span> n<span class="op">;</span> u <span class="op">++</span> <span class="op">)</span></span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>fa<span class="op">[</span>u<span class="op">])</span>  <span class="co">// æ‰¾åˆ°æ ¹èŠ‚ç‚¹</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#123;</span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>            dfs<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>            cout <span class="op">&lt;&lt;</span> max<span class="op">(</span>f<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">],</span> f<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">])</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#125;</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
<h3 id="æˆ˜ç•¥æ¸¸æˆ">æˆ˜ç•¥æ¸¸æˆ</h3>
<p><strong>é¢˜æ„ï¼š</strong> ç»™å®šä¸€æ£µåŒ…å« <span
class="math inline">\(n\)</span> ä¸ªç»“ç‚¹çš„ æ ‘ï¼Œä»¥åŠæ ‘ä¸Šçš„ <span
class="math inline">\(nâˆ’1\)</span> æ¡è¾¹</p>
<p>æˆ‘ä»¬éœ€è¦åœ¨è¿™ <span class="math inline">\(n\)</span>
ä¸ªç»“ç‚¹ä¸­ï¼Œé€‰æ‹©ä¸€å®šæ•°é‡çš„ç»“ç‚¹æ”¾ä¸Šå“¨å…µ</p>
<p>æœ€ç»ˆè¦æ±‚ï¼Œå¯¹äºæ ‘ä¸­çš„æ¯ä¸€æ¡è¾¹è¾¹çš„å·¦å³ä¸¤ç«¯ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªç»“ç‚¹ä¸Šæ”¾ç½®äº†å“¨å…µ</p>
<p>æ±‚è§£ä¸€ä¸ªæ–¹æ¡ˆï¼Œä½¿å¾—æ”¾ç½®çš„å“¨å…µæ•°é‡æœ€å°‘ï¼Œè¾“å‡ºè¯¥æ–¹æ¡ˆæ”¾ç½®çš„å“¨å…µæ•°é‡</p>
<p><strong>åˆ†æï¼š</strong>
æœ¬é¢˜ä¸ä¸Šä¸€é¢˜æ²¡æœ‰ä¸Šå¸çš„èˆä¼šååˆ†ç±»ä¼¼ï¼Œè€ƒè™‘ä»¥ç»“ç‚¹ <span
class="math inline">\(u\)</span> ä¸º æ ¹èŠ‚ç‚¹ çš„å­æ ‘ï¼Œè¯¥å­æ ‘æ‰€æœ‰çš„æ–¹æ¡ˆ</p>
<p>å¯ä»¥ç”±å½“å‰ç»“ç‚¹æ”¾æˆ–ä¸æ”¾å“¨å…µè¿›è¡Œåˆ’åˆ†</p>
<p>è¿™ä¹Ÿæ˜¯ä¸€ç§ çŠ¶æ€æœºæ¨¡å‹(å€Ÿå›¾)</p>
<figure>
<img src="https://s2.loli.net/2022/07/18/RiXcaYN7FyorMuE.jpg"
alt="pic" />
<figcaption aria-hidden="true">pic</figcaption>
</figure>
<ul>
<li>å¦‚æœå½“å‰ç»“ç‚¹æ²¡æœ‰æ”¾å“¨å…µ(0)ï¼Œåˆ™è¯¥å­æ ‘ä¸­ï¼Œè¿è¾¹çš„å¦ä¸€ç«¯ï¼Œå¿…é¡»æ”¾ç½®å“¨å…µ(1)</li>
<li>å¦‚æœå½“å‰ç»“ç‚¹æ”¾ç½®äº†å“¨å…µ(1)ï¼Œåˆ™è¯¥å­æ ‘ä¸­ï¼Œè¿è¾¹çš„å¦ä¸€ç«¯ï¼Œå¯ä»¥æ”¾ç½®å“¨å…µ(1)ï¼Œä¹Ÿå¯ä»¥ä¸æ”¾ç½®å“¨å…µ(0)</li>
</ul>
<p><strong>çŠ¶æ€è¡¨ç¤ºï¼š</strong></p>
<ul>
<li><p><span class="math inline">\(f[u][0]\)</span> ä»¥ <span
class="math inline">\(u\)</span> ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œ <span
class="math inline">\(u\)</span>
è¿™ä¸ªç‚¹çš„ä¸æ”¾ç½®å“¨å…µçš„æœ€å°‘å“¨å…µæ€»æ•°</p></li>
<li><p><span class="math inline">\(f[u][1]\)</span> ä»¥ <span
class="math inline">\(u\)</span> ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œ <span
class="math inline">\(u\)</span> è¿™ä¸ªç‚¹çš„æ”¾ç½®å“¨å…µçš„æœ€å°‘å“¨å…µæ€»æ•°</p></li>
</ul>
<p><strong>çŠ¶æ€è®¡ç®—ï¼š</strong> å¯¹äºå½“å‰èŠ‚ç‚¹ <span
class="math inline">\(u\)</span> çš„æ‰€æœ‰å­èŠ‚ç‚¹ <span
class="math inline">\(v\)</span></p>
<ul>
<li><span class="math inline">\(f[u][0] = \sum (f[v][1])\)</span> æ²¡é€‰å–
<span class="math inline">\(u\)</span>ï¼Œå¿…é¡»é€‰æ‹© <span
class="math inline">\(v\)</span></li>
<li><span class="math inline">\(f[u][1] = \sum \min(f[v][0],
f[v][1])\)</span> é€‰å–äº† <span class="math inline">\(u\)</span>ï¼Œå¯é€‰æ‹©
<span class="math inline">\(v\)</span> ä¹Ÿå¯ä»¥ä¸é€‰æ‹© <span
class="math inline">\(v\)</span></li>
</ul>
<p><strong>å¤æ‚åº¦ï¼š</strong> <span
class="math display">\[O(n)\]</span></p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;vector&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">1505</span><span class="op">;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fa<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> f<span class="op">[</span>N<span class="op">][</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> e<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">)</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    f<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> f<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// åˆå§‹åŒ–</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> v<span class="op">:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        f<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">+=</span> f<span class="op">[</span>v<span class="op">][</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        f<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">+=</span> min<span class="op">(</span>f<span class="op">[</span>v<span class="op">][</span><span class="dv">0</span><span class="op">],</span> f<span class="op">[</span>v<span class="op">][</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span><span class="op">(</span>cin <span class="op">&gt;&gt;</span> n<span class="op">)</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>fa<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span> fa<span class="op">);</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        memset<span class="op">(</span>e<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">sizeof</span> e<span class="op">);</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#123;</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> a<span class="op">,</span> b<span class="op">,</span> siz<span class="op">;</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>            scanf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">:(</span><span class="sc">%d</span><span class="st">)&quot;</span><span class="op">,</span> <span class="op">&amp;</span>a<span class="op">,</span> <span class="op">&amp;</span>siz<span class="op">);</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> <span class="op">(</span>siz <span class="op">--</span> <span class="op">)</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>            <span class="op">&#123;</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>                cin <span class="op">&gt;&gt;</span> b<span class="op">;</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>                e<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>                fa<span class="op">[</span>b<span class="op">]</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span>  <span class="co">// ç”¨äºåˆ¤æ–­æ ¹èŠ‚ç‚¹</span></span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>            <span class="op">&#125;</span></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#125;</span></span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> u <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> u <span class="op">&lt;</span> n<span class="op">;</span> u <span class="op">++</span> <span class="op">)</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#123;</span></span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(!</span>fa<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>            <span class="op">&#123;</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>                dfs<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>                cout <span class="op">&lt;&lt;</span> min<span class="op">(</span>f<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">],</span> f<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">])</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>            <span class="op">&#125;</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#125;</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
<h3 id="çš‡å®«çœ‹å®ˆ">çš‡å®«çœ‹å®ˆ</h3>
<p><strong>é¢˜æ„ï¼š</strong>ç»™å®šä¸€ä¸ªå«æœ‰ <span
class="math inline">\(n\)</span> ä¸ªç»“ç‚¹çš„æ ‘</p>
<p>æ¯ä¸ªç»“ç‚¹æœ‰ä¸€ä¸ª æƒå€¼ <span class="math inline">\(w_i\)</span> è¡¨ç¤ºåœ¨ç¬¬
<span class="math inline">\(i\)</span> ä¸ªç‚¹ä¸Šæ”¾ç½®å“¨å…µçš„èŠ±è´¹</p>
<p>å¯¹äºæ¯ä¸ªå“¨å…µæ¥è¯´ï¼Œä»–å¯ä»¥è§‚å¯Ÿå½“å‰ç»“ç‚¹ï¼Œä»¥åŠæ‰€æœ‰ä¸å½“å‰ç‚¹ç›¸è¿çš„ç›¸é‚»ç»“ç‚¹</p>
<p>æ±‚è§£ä¸€ç§æ”¾ç½®å“¨å…µçš„æ–¹æ¡ˆï¼Œä½¿å¾—æ¯ä¸ªç»“ç‚¹éƒ½è¢«è§‚å¯Ÿåˆ°ï¼Œä¸”æ–¹æ¡ˆçš„èŠ±è´¹æœ€å°</p>
<p><strong>åˆ†æï¼š</strong>
æœ¬é¢˜è¿˜æ˜¯çŠ¶æ€æœºæ¨¡å‹ï¼Œæ‰€ä»¥å¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæœ‰ä¸‰ç§æƒ…å†µ</p>
<ul>
<li>çˆ¶èŠ‚ç‚¹æ”¾ç½®å“¨å…µï¼Œæ‰€æœ‰å­èŠ‚ç‚¹éƒ½å¯æ”¾å¯ä¸æ”¾å“¨å…µ</li>
<li>çˆ¶èŠ‚ç‚¹ä¸æ”¾å“¨å…µï¼Œä½†æ˜¯ä»–è‡³å°‘æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹æ”¾ç½®å“¨å…µï¼Œè§‚å¯Ÿä½äº†ä»–</li>
<li>çˆ¶èŠ‚ç‚¹ä¸æ”¾å“¨å…µï¼Œä½†çˆ¶èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ”¾ç½®å“¨å…µè§‚å¯Ÿï¼Œåˆ™å­èŠ‚ç‚¹å¯æ”¾å¯ä¸æ”¾å“¨å…µ</li>
</ul>
<p>å¯ä»¥ç®€åŒ–ä¸ºä¸‰ä¸ªç‚¹çš„çŠ¶æ€æœºæ¨¡å‹</p>
<ul>
<li>è¢«çˆ¶èŠ‚ç‚¹è§‚å¯Ÿ (0)</li>
<li>è¢«å­èŠ‚ç‚¹è§‚å¯Ÿ (1)</li>
<li>è¢«è‡ªå·±è§‚å¯Ÿ (2)</li>
</ul>
<p><strong>çŠ¶æ€è¡¨ç¤ºï¼š</strong></p>
<ul>
<li><span class="math inline">\(f[u][0]\)</span> ä»¥ <span
class="math inline">\(u\)</span> ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œ <span
class="math inline">\(u\)</span> è¿™ä¸ªç‚¹çš„çˆ¶èŠ‚ç‚¹æ”¾ç½®å“¨å…µçš„æœ€å°‘èŠ±è´¹</li>
<li><span class="math inline">\(f[u][1]\)</span> ä»¥ <span
class="math inline">\(u\)</span> ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œ <span
class="math inline">\(u\)</span>
è¿™ä¸ªç‚¹çš„è‡³å°‘å…¶ä¸­ä¸€ä¸ªå­èŠ‚ç‚¹æ”¾ç½®å“¨å…µçš„æœ€å°‘èŠ±è´¹</li>
<li><span class="math inline">\(f[u][2]\)</span> ä»¥ <span
class="math inline">\(u\)</span> ä¸ºæ ¹çš„å­æ ‘ä¸­ï¼Œ <span
class="math inline">\(u\)</span>
è¿™ä¸ªç‚¹çš„è‡³å°‘å…¶ä¸­ä¸€ä¸ªå­èŠ‚ç‚¹æ”¾ç½®å“¨å…µçš„æœ€å°‘èŠ±è´¹</li>
</ul>
<p><strong>çŠ¶æ€è®¡ç®—ï¼š</strong> å¯¹äºå½“å‰èŠ‚ç‚¹ <span
class="math inline">\(u\)</span> çš„æ‰€æœ‰å­èŠ‚ç‚¹ <span
class="math inline">\(v\)</span></p>
<ul>
<li><p><span class="math inline">\(f[u][0] = \sum \min(f[v][1],
f[v][2])\)</span> æ²¡é€‰å– <span class="math inline">\(u\)</span>ï¼Œ<span
class="math inline">\(v\)</span> å¯é€‰å¯ä¸é€‰</p></li>
<li><p><span class="math inline">\(f[u][1] = \min( f[v][2] +\sum
\min(f[k][1], f[v][2]))\)</span></p>
<p>æšä¸¾å­èŠ‚ç‚¹ï¼Œå½“é€‰å–äº†å…¶ä¸­çš„ä¸€ä¸ªå­èŠ‚ç‚¹ <span
class="math inline">\(v\)</span> ï¼Œåˆ™å…¶ä½™æ‰€æœ‰å­èŠ‚ç‚¹(<span
class="math inline">\(k\)</span>)å¯é€‰å¯ä¸é€‰</p>
<p>è€Œ <span class="math inline">\(f[u][0]=\sum \min(f[v][1],
f[v][2])\)</span> å…¶ä¸­ <span class="math inline">\(\sum \min(f[k][1],
f[v][2])\Longrightarrow f[u][0] - \min
(f[v][1],f[v][2])\)</span></p></li>
<li><p><span class="math inline">\(f[u][2] = \sum
\min(f[v][0],f[v][1],f[v][2])\)</span> é€‰å–äº† <span
class="math inline">\(u\)</span>ï¼Œåˆ™å­èŠ‚ç‚¹ <span
class="math inline">\(v\)</span> éšæ„ï¼Œ æ³¨æ„è¦åŠ ä¸Š <span
class="math inline">\(u\)</span> çš„æƒå€¼</p></li>
</ul>
<p><strong>å¤æ‚åº¦ï¼š</strong> <span
class="math inline">\(O(n)\)</span></p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;iostream&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;cstring&gt;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;algorithm&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> std<span class="op">;</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="at">const</span> <span class="dt">int</span> N <span class="op">=</span> <span class="dv">1510</span><span class="op">;</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="kw">typedef</span> pair<span class="op">&lt;</span><span class="dt">int</span><span class="op">,</span> <span class="dt">int</span><span class="op">&gt;</span> PII<span class="op">;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n<span class="op">;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>vector<span class="op">&lt;</span><span class="dt">int</span><span class="op">&gt;</span> e<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="dt">bool</span> fa<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> w<span class="op">[</span>N<span class="op">],</span> f<span class="op">[</span>N<span class="op">][</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> dfs<span class="op">(</span><span class="dt">int</span> u<span class="op">)</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>    f<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>    <span class="co">// è¢«çˆ¶èŠ‚ç‚¹è§‚å¯Ÿ</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>    f<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="fl">2e9</span><span class="op">;</span>  <span class="co">// è¢«æŸä¸ªå­èŠ‚ç‚¹è§‚å¯Ÿ, å…ˆåˆå§‹åŒ–ä¸ºæœ€å¤§å€¼</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>    f<span class="op">[</span>u<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> w<span class="op">[</span>u<span class="op">];</span> <span class="co">// è¢«è‡ªå·±è§‚å¯Ÿ</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> v<span class="op">:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>        dfs<span class="op">(</span>v<span class="op">);</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>        f<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">]</span> <span class="op">+=</span> min<span class="op">(</span>f<span class="op">[</span>v<span class="op">][</span><span class="dv">1</span><span class="op">],</span> f<span class="op">[</span>v<span class="op">][</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>        f<span class="op">[</span>u<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">+=</span> min<span class="op">(</span>min<span class="op">(</span>f<span class="op">[</span>v<span class="op">][</span><span class="dv">0</span><span class="op">],</span> f<span class="op">[</span>v<span class="op">][</span><span class="dv">1</span><span class="op">]),</span> f<span class="op">[</span>v<span class="op">][</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="kw">auto</span> v<span class="op">:</span> e<span class="op">[</span>u<span class="op">])</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>        <span class="co">//f[u][0]ä¸­è®°å½•äº†sum&#123;min(f(u_son,1), f(u_son,2))&#125;ï¼Œå†ä»ä¸­å‡å»vçš„è´¡çŒ®å³å¯</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>        f<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> min<span class="op">(</span>f<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">],</span> f<span class="op">[</span>v<span class="op">][</span><span class="dv">2</span><span class="op">]</span> <span class="op">+</span> f<span class="op">[</span>u<span class="op">][</span><span class="dv">0</span><span class="op">]</span>  <span class="op">-</span> min<span class="op">(</span>f<span class="op">[</span>v<span class="op">][</span><span class="dv">1</span><span class="op">],</span> f<span class="op">[</span>v<span class="op">][</span><span class="dv">2</span><span class="op">]));</span></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a><span class="op">&#123;</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>    cin <span class="op">&gt;&gt;</span> n<span class="op">;</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> a<span class="op">,</span> cost<span class="op">,</span> cnt<span class="op">;</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>        cin <span class="op">&gt;&gt;</span> a <span class="op">&gt;&gt;</span> cost <span class="op">&gt;&gt;</span> cnt<span class="op">;</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>        w<span class="op">[</span>a<span class="op">]</span> <span class="op">=</span> cost<span class="op">;</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> cnt<span class="op">;</span> i <span class="op">++</span> <span class="op">)</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#123;</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> b<span class="op">;</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>            cin <span class="op">&gt;&gt;</span> b<span class="op">;</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>            e<span class="op">[</span>a<span class="op">].</span>push_back<span class="op">(</span>b<span class="op">);</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>            fa<span class="op">[</span>b<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// åˆ¤æ–­æ˜¯å¦æ˜¯æ ¹èŠ‚ç‚¹</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#125;</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> u <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> u <span class="op">&lt;=</span> n<span class="op">;</span> u <span class="op">++</span> <span class="op">)</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#123;</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>fa<span class="op">[</span>u<span class="op">])</span>  <span class="co">// æ˜¯æ ¹èŠ‚ç‚¹</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#123;</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>            dfs<span class="op">(</span>u<span class="op">);</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>            cout <span class="op">&lt;&lt;</span> min<span class="op">(</span>f<span class="op">[</span>u<span class="op">][</span><span class="dv">1</span><span class="op">],</span> f<span class="op">[</span>u<span class="op">][</span><span class="dv">2</span><span class="op">])</span> <span class="op">&lt;&lt;</span> endl<span class="op">;</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>        <span class="op">&#125;</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">&#125;</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a><span class="op">&#125;</span></span></code></pre></div>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2022/07/14/%E7%BA%BF%E6%80%A7DP/"><i class="fa fa-arrow-left" aria-hidden="true"></i></a><a class="next" href="/2022/07/28/%E7%8A%B6%E5%8E%8BDP/"><i class="fa fa-arrow-right" aria-hidden="true"></i></a></div><ins class="adsbygoogle adsense-bottom" style="display:block" data-ad-client="ca-pub-6188640546219653" data-ad-slot="6129396565" data-ad-format="auto"></ins><div class="fb-comments-area"><div class="fb-comments" data-href="http://example.com/2022/07/24/æ ‘å½¢DP/" data-width="700" data-numposts="5"></div></div><div class="copyright"><p>Â© 2012 - 2023 <a href="https://github.com/stunstunstun" target="_blank">Minhyeok Jung</a>. Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/stunstunstun/hexo-theme-chiangmai" target="_blank">hexo-theme-chiangmai</a>.</p></div></footer></div><script async="" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><script>window.fbAsyncInit=function(){FB.init({appId:"1258629384258634",cookie:!0,xfbml:!0,version:"v2.8"}),FB.AppEvents.logPageView()},function(e,n,t){var o,c=e.getElementsByTagName(n)[0];e.getElementById(t)||((o=e.createElement(n)).id=t,o.src="//connect.facebook.net/en_US/sdk.js",c.parentNode.insertBefore(o,c))}(document,"script","facebook-jssdk");</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create','UA-97419941-1','auto');ga('send','pageview');</script></body></html>